{"version":3,"sources":["ControlBar.tsx"],"names":["ControlBar","editingMode","setEditingMode","editingModeState","imageData","imageDataState","processing","setProcessing","processingState","mode","onCloseEditor","onEditingComplete","EditorContext","performCrop","shouldDisableDoneButton","onFinishEditing","onPressBack","uri","styles","container","StyleSheet","create","width","height","backgroundColor","flexDirection","justifyContent","alignItems","paddingHorizontal"],"mappings":";;;;;;;AAAA;;AACA;;AAEA;;AACA;;AACA;;AAEA;;AAEA;;;;;;AAEA,SAASA,UAAT,GAAsB;AACpB;AACA,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgC,4BAAeC,uBAAf,CAAtC;AACA,QAAM,CAACC,SAAD,IAAc,4BAAeC,qBAAf,CAApB;AACA,QAAM,CAACC,UAAD,EAAaC,aAAb,IAA8B,4BAAeC,sBAAf,CAApC;AACA,QAAM;AAAEC,IAAAA,IAAF;AAAQC,IAAAA,aAAR;AAAuBC,IAAAA;AAAvB,MAA6C,sBAAWC,oBAAX,CAAnD;AAEA,QAAMC,WAAW,GAAG,qCAApB;AAEA,QAAMC,uBAAuB,GAC3Bb,WAAW,KAAK,kBAAhB,IAAsCQ,IAAI,KAAK,WADjD;;AAGA,QAAMM,eAAe,GAAG,YAAY;AAClC,QAAIN,IAAI,KAAK,MAAb,EAAqB;AACnBF,MAAAA,aAAa,CAAC,KAAD,CAAb;AACAI,MAAAA,iBAAiB,CAACP,SAAD,CAAjB;AACAM,MAAAA,aAAa;AACd,KAJD,MAIO,IAAID,IAAI,KAAK,WAAb,EAA0B;AAC/B,YAAMI,WAAW,EAAjB;AACD;AACF,GARD;;AAUA,QAAMG,WAAW,GAAG,MAAM;AACxB,QAAIP,IAAI,KAAK,MAAb,EAAqB;AACnB,UAAIR,WAAW,KAAK,kBAApB,EAAwC;AACtCS,QAAAA,aAAa;AACd,OAFD,MAEO;AACLR,QAAAA,cAAc,CAAC,kBAAD,CAAd;AACD;AACF,KAND,MAMO,IAAIO,IAAI,KAAK,WAAb,EAA0B;AAC/BC,MAAAA,aAAa;AACd;AACF,GAVD,CAtBoB,CAkCpB;AACA;AACA;;;AACA,uBAAU,MAAM;AACd,QACED,IAAI,KAAK,WAAT,IACAL,SAAS,CAACa,GADV,IAEAhB,WAAW,KAAK,kBAHlB,EAIE;AACAU,MAAAA,iBAAiB,CAACP,SAAD,CAAjB;AACAM,MAAAA,aAAa;AACd;AACF,GATD,EASG,CAACN,SAAD,EAAYH,WAAZ,CATH;AAWA,sBACE,oBAAC,iBAAD;AAAM,IAAA,KAAK,EAAEiB,MAAM,CAACC;AAApB,kBACE,oBAAC,sBAAD;AAAY,IAAA,MAAM,EAAC,YAAnB;AAAgC,IAAA,IAAI,EAAC,MAArC;AAA4C,IAAA,OAAO,EAAEH;AAArD,IADF,eAEE,oBAAC,sBAAD;AACE,IAAA,MAAM,EAAC,MADT;AAEE,IAAA,IAAI,EAAC,MAFP;AAGE,IAAA,OAAO,EAAED,eAHX;AAIE,IAAA,QAAQ,EAAED;AAJZ,IAFF,CADF;AAWD;;AAID,MAAMI,MAAM,GAAGE,wBAAWC,MAAX,CAAkB;AAC/BF,EAAAA,SAAS,EAAE;AACTG,IAAAA,KAAK,EAAE,MADE;AAETC,IAAAA,MAAM,EAAE,EAFC;AAGTC,IAAAA,eAAe,EAAE,MAHR;AAITC,IAAAA,aAAa,EAAE,KAJN;AAKTC,IAAAA,cAAc,EAAE,eALP;AAMTC,IAAAA,UAAU,EAAE,QANH;AAOTC,IAAAA,iBAAiB,EAAE;AAPV;AADoB,CAAlB,CAAf","sourcesContent":["import * as React from \"react\";\nimport { View, StyleSheet } from \"react-native\";\nimport _ from \"lodash\";\nimport { useRecoilState } from \"recoil\";\nimport { editingModeState, imageDataState, processingState } from \"./Store\";\nimport { IconButton } from \"./components/IconButton\";\nimport { useContext } from \"react\";\nimport { EditorContext } from \"./index\";\nimport { useEffect } from \"react\";\nimport { usePerformCrop } from \"./customHooks/usePerformCrop\";\n\nfunction ControlBar() {\n  //\n  const [editingMode, setEditingMode] = useRecoilState(editingModeState);\n  const [imageData] = useRecoilState(imageDataState);\n  const [processing, setProcessing] = useRecoilState(processingState);\n  const { mode, onCloseEditor, onEditingComplete } = useContext(EditorContext);\n\n  const performCrop = usePerformCrop();\n\n  const shouldDisableDoneButton =\n    editingMode !== \"operation-select\" && mode !== \"crop-only\";\n\n  const onFinishEditing = async () => {\n    if (mode === \"full\") {\n      setProcessing(false);\n      onEditingComplete(imageData);\n      onCloseEditor();\n    } else if (mode === \"crop-only\") {\n      await performCrop();\n    }\n  };\n\n  const onPressBack = () => {\n    if (mode === \"full\") {\n      if (editingMode === \"operation-select\") {\n        onCloseEditor();\n      } else {\n        setEditingMode(\"operation-select\");\n      }\n    } else if (mode === \"crop-only\") {\n      onCloseEditor();\n    }\n  };\n\n  // Complete the editing process if we are in crop only mode after the editingMode gets set\n  // back to operation select (happens internally in usePerformCrop) - can't do it in onFinishEditing\n  // else it gets stale state - may need to refactor the hook as this feels hacky\n  useEffect(() => {\n    if (\n      mode === \"crop-only\" &&\n      imageData.uri &&\n      editingMode === \"operation-select\"\n    ) {\n      onEditingComplete(imageData);\n      onCloseEditor();\n    }\n  }, [imageData, editingMode]);\n\n  return (\n    <View style={styles.container}>\n      <IconButton iconID=\"arrow-back\" text=\"Back\" onPress={onPressBack} />\n      <IconButton\n        iconID=\"done\"\n        text=\"Done\"\n        onPress={onFinishEditing}\n        disabled={shouldDisableDoneButton}\n      />\n    </View>\n  );\n}\n\nexport { ControlBar };\n\nconst styles = StyleSheet.create({\n  container: {\n    width: \"100%\",\n    height: 80,\n    backgroundColor: \"#333\",\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    paddingHorizontal: 4,\n  },\n});\n"]}