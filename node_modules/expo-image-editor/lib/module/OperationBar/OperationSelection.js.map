{"version":3,"sources":["OperationSelection.tsx"],"names":["React","StyleSheet","View","TouchableOpacity","ScrollView","Icon","IconButton","editingModeState","useRecoilState","useContext","EditorContext","useMemo","operations","transform","title","iconID","operationID","adjust","OperationSelection","allowedTransformOperations","allowedAdjustmentOperations","isTransformOnly","isAdjustmentOnly","selectedOperationGroup","setSelectedOperationGroup","useState","setEditingMode","filteredOperations","filteredTransforms","filter","op","includes","filteredAdjustments","styles","opRow","map","item","index","opContainer","modeRow","modeButton","backgroundColor","create","height","width","justifyContent","alignItems","marginLeft","flexDirection","flex"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport {\n  Platform,\n  StyleSheet,\n  View,\n  TouchableOpacity,\n  ScrollView,\n} from \"react-native\";\nimport { Icon } from \"../components/Icon\";\nimport { IconButton } from \"../components/IconButton\";\nimport { editingModeState, EditingModes } from \"../Store\";\nimport { useRecoilState } from \"recoil\";\nimport { useContext } from \"react\";\nimport {\n  AdjustmentOperations,\n  EditingOperations,\n  EditorContext,\n  TransformOperations,\n} from \"..\";\nimport { useMemo } from \"react\";\n\ninterface Operation<T> {\n  title: string;\n  iconID: React.ComponentProps<typeof Icon>[\"iconID\"];\n  operationID: T;\n}\n\ninterface Operations {\n  transform: Operation<TransformOperations>[];\n  adjust: Operation<AdjustmentOperations>[];\n}\n\nconst operations: Operations = {\n  transform: [\n    {\n      title: \"Crop\",\n      iconID: \"crop\",\n      operationID: \"crop\",\n    },\n    {\n      title: \"Rotate\",\n      iconID: \"rotate-90-degrees-ccw\",\n      operationID: \"rotate\",\n    },\n  ],\n  adjust: [\n    {\n      title: \"Blur\",\n      iconID: \"blur-on\",\n      operationID: \"blur\",\n    },\n  ],\n};\n\nexport function OperationSelection() {\n  //\n  const { allowedTransformOperations, allowedAdjustmentOperations } =\n    useContext(EditorContext);\n\n  const isTransformOnly =\n    allowedTransformOperations && !allowedAdjustmentOperations;\n  const isAdjustmentOnly =\n    allowedAdjustmentOperations && !allowedTransformOperations;\n\n  const [selectedOperationGroup, setSelectedOperationGroup] = React.useState<\n    \"transform\" | \"adjust\"\n  >(isAdjustmentOnly ? \"adjust\" : \"transform\");\n\n  const [, setEditingMode] = useRecoilState(editingModeState);\n\n  const filteredOperations = useMemo(() => {\n    // If neither are specified then allow the full range of operations\n    if (!allowedTransformOperations && !allowedAdjustmentOperations) {\n      return operations;\n    }\n    const filteredTransforms = allowedTransformOperations\n      ? operations.transform.filter((op) =>\n          allowedTransformOperations.includes(op.operationID)\n        )\n      : operations.transform;\n    const filteredAdjustments = allowedAdjustmentOperations\n      ? operations.adjust.filter((op) =>\n          allowedAdjustmentOperations.includes(op.operationID)\n        )\n      : operations.adjust;\n    if (isTransformOnly) {\n      return { transform: filteredTransforms, adjust: [] };\n    }\n    if (isAdjustmentOnly) {\n      return { adjust: filteredAdjustments, transform: [] };\n    }\n    return { transform: filteredTransforms, adjust: filteredAdjustments };\n  }, [\n    allowedTransformOperations,\n    allowedAdjustmentOperations,\n    isTransformOnly,\n    isAdjustmentOnly,\n  ]);\n\n  return (\n    <>\n      <ScrollView style={styles.opRow} horizontal>\n        {\n          //@ts-ignore\n          filteredOperations[selectedOperationGroup].map(\n            (item: Operation<EditingOperations>, index: number) => (\n              <View style={styles.opContainer} key={item.title}>\n                <IconButton\n                  text={item.title}\n                  iconID={item.iconID}\n                  onPress={() => setEditingMode(item.operationID)}\n                />\n              </View>\n            )\n          )\n        }\n      </ScrollView>\n      {!isTransformOnly && !isAdjustmentOnly ? (\n        <View style={styles.modeRow}>\n          <TouchableOpacity\n            style={[\n              styles.modeButton,\n              selectedOperationGroup === \"transform\" && {\n                backgroundColor: \"#333\",\n              },\n            ]}\n            onPress={() => setSelectedOperationGroup(\"transform\")}\n          >\n            <Icon iconID=\"transform\" text=\"Transform\" />\n          </TouchableOpacity>\n          <TouchableOpacity\n            style={[\n              styles.modeButton,\n              selectedOperationGroup === \"adjust\" && {\n                backgroundColor: \"#333\",\n              },\n            ]}\n            onPress={() => setSelectedOperationGroup(\"adjust\")}\n          >\n            <Icon iconID=\"tune\" text=\"Adjust\" />\n          </TouchableOpacity>\n        </View>\n      ) : null}\n    </>\n  );\n}\n\nconst styles = StyleSheet.create({\n  opRow: {\n    height: 80,\n    width: \"100%\",\n    backgroundColor: \"#333\",\n  },\n  opContainer: {\n    height: \"100%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    marginLeft: 16,\n  },\n  modeRow: {\n    height: 80,\n    width: \"100%\",\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-around\",\n  },\n  modeButton: {\n    height: 80,\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"#222\",\n  },\n});\n"]}